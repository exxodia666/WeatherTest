import { axiosWeather } from './../../services/api/index';
import { GET_WEATHER_REQUEST, getWeatherSuccess, getWeatherError, getWeatherRequest } from './../actions/getWeather';
import { call, put, takeLatest } from 'redux-saga/effects'

function* getWeatherWorker(action: typeof getWeatherRequest) {
    console.log('worker');
    const { payload } = action;
    try {
        const { data, status } = yield call(axiosWeather, payload);
        if ([5, 4].includes(status.toString()[0])) {
            throw new Error('Error');
        }
        yield put(getWeatherSuccess(data.list));
    } catch (e) {
        yield put(getWeatherError(e));
    }
}
function* getWeatherWatcher() {
    yield takeLatest(GET_WEATHER_REQUEST, getWeatherWorker);
}

export default getWeatherWatcher;

// { "city": { 
//     "coord": { "lat": 38.3, "lon": 21.7833 }, 
//     "country": "GR", 
//     "id": 254315, 
//     "name": "Rio", 
//     "population": 6083, 
//     "sunrise": 1626405722, 
//     "sunset": 1626458124, 
//     "timezone": 10800 
// }, "cnt": 40, "cod": "200", "list": [{ "clouds": [Object], "dt": 1626447600, "dt_txt": "2021-07-16 15:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626458400, "dt_txt": "2021-07-16 18:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626469200, "dt_txt": "2021-07-16 21:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626480000, "dt_txt": "2021-07-17 00:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626490800, "dt_txt": "2021-07-17 03:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626501600, "dt_txt": "2021-07-17 06:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626512400, "dt_txt": "2021-07-17 09:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626523200, "dt_txt": "2021-07-17 12:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626534000, "dt_txt": "2021-07-17 15:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626544800, "dt_txt": "2021-07-17 18:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626555600, "dt_txt": "2021-07-17 21:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626566400, "dt_txt": "2021-07-18 00:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626577200, "dt_txt": "2021-07-18 03:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626588000, "dt_txt": "2021-07-18 06:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626598800, "dt_txt": "2021-07-18 09:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 7650, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626609600, "dt_txt": "2021-07-18 12:00:00", "main": [Object], "pop": 0.2, "rain": [Object], "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626620400, "dt_txt": "2021-07-18 15:00:00", "main": [Object], "pop": 0.21, "rain": [Object], "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626631200, "dt_txt": "2021-07-18 18:00:00", "main": [Object], "pop": 0.28, "rain": [Object], "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626642000, "dt_txt": "2021-07-18 21:00:00", "main": [Object], "pop": 0.08, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626652800, "dt_txt": "2021-07-19 00:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626663600, "dt_txt": "2021-07-19 03:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626674400, "dt_txt": "2021-07-19 06:00:00", "main": [Object], "pop": 0.03, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626685200, "dt_txt": "2021-07-19 09:00:00", "main": [Object], "pop": 0.35, "rain": [Object], "sys": [Object], "visibility": 6060, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626696000, "dt_txt": "2021-07-19 12:00:00", "main": [Object], "pop": 0.41, "rain": [Object], "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626706800, "dt_txt": "2021-07-19 15:00:00", "main": [Object], "pop": 0.33, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626717600, "dt_txt": "2021-07-19 18:00:00", "main": [Object], "pop": 0.27, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626728400, "dt_txt": "2021-07-19 21:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626739200, "dt_txt": "2021-07-20 00:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626750000, "dt_txt": "2021-07-20 03:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626760800, "dt_txt": "2021-07-20 06:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626771600, "dt_txt": "2021-07-20 09:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 7851, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626782400, "dt_txt": "2021-07-20 12:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 8707, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626793200, "dt_txt": "2021-07-20 15:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626804000, "dt_txt": "2021-07-20 18:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626814800, "dt_txt": "2021-07-20 21:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626825600, "dt_txt": "2021-07-21 00:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626836400, "dt_txt": "2021-07-21 03:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626847200, "dt_txt": "2021-07-21 06:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626858000, "dt_txt": "2021-07-21 09:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }, { "clouds": [Object], "dt": 1626868800, "dt_txt": "2021-07-21 12:00:00", "main": [Object], "pop": 0, "sys": [Object], "visibility": 10000, "weather": [Array], "wind": [Object] }], "message": 0 }
